
import { useState, useCallback } from 'react';
import { useToast } from '@/components/ui/use-toast';

export const useGuichetieresData = () => {
  const { toast } = useToast();
  const [guichetieres, setGuichetieres] = useState([]);
  const [agences, setAgences] = useState([]);

  const loadData = useCallback(() => {
    try {
      const storedGuichetieres = JSON.parse(localStorage.getItem('pmuGuichetieres')) || [];
      setGuichetieres(storedGuichetieres);
      const storedAgences = JSON.parse(localStorage.getItem('pmuAgences')) || [];
      setAgences(storedAgences);
    } catch (error) {
      toast({ title: "Erreur de chargement", description: "Impossible de charger les données.", variant: "destructive" });
      setGuichetieres([]);
      setAgences([]);
    }
  }, [toast]);

  const saveData = useCallback((data) => {
    try {
      localStorage.setItem('pmuGuichetieres', JSON.stringify(data));
      setGuichetieres(data);
    } catch (error) {
      toast({ title: "Erreur d'enregistrement", description: "Impossible d'enregistrer les données.", variant: "destructive" });
    }
  }, [toast]);

  return { guichetieres, agences, loadData, saveData };
};
